<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Doggyco 3.2</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;}

body{
overflow:hidden;
font-family:Segoe UI,sans-serif;
background:linear-gradient(#87CEEB,#e0f6ff);
display:flex;
justify-content:center;
align-items:center;
height:100vh;
}

#gameWrapper{
position:relative;
width:400px;
height:650px;
overflow:hidden;
border-radius:25px;
box-shadow:0 20px 50px rgba(0,0,0,0.3);
background:linear-gradient(#87CEEB,#ffffff);
}

/* ===== UI PANEL ===== */
#uiPanel{
position:absolute;
top:10px;
left:10px;
right:10px;
display:flex;
justify-content:space-between;
background:rgba(255,255,255,0.8);
backdrop-filter:blur(6px);
padding:8px 15px;
border-radius:20px;
font-weight:bold;
color:#333;
box-shadow:0 5px 15px rgba(0,0,0,0.1);
}

canvas{display:block;}

/* ===== CONTROL BAR ===== */
#controlBar{
position:absolute;
bottom:0;
width:100%;
height:70px;
background:#1c1c1c;
}

#slider{
position:absolute;
bottom:20px;
left:50%;
transform:translateX(-50%);
width:80%;
appearance:none;
height:12px;
border-radius:10px;
background:linear-gradient(90deg,#4facfe,#0052d4,#4facfe);
outline:none;
}

#slider::-webkit-slider-thumb{
appearance:none;
width:25px;
height:25px;
border-radius:50%;
background:white;
border:3px solid #0052d4;
cursor:pointer;
}

/* ===== OVERLAY ===== */
.overlay{
position:absolute;
top:0;
left:0;
width:100%;
height:100%;
background:rgba(0,0,0,0.85);
display:flex;
flex-direction:column;
justify-content:center;
align-items:center;
color:white;
text-align:center;
padding:20px;
}

button{
padding:10px 20px;
border:none;
border-radius:20px;
background:linear-gradient(45deg,#ff9ecf,#ffd166);
font-weight:bold;
margin-top:10px;
cursor:pointer;
}
</style>
</head>
<body>

<div id="gameWrapper">

<div id="uiPanel">
<div>‚≠ê <span id="score">0</span></div>
<div>‚ù§Ô∏è <span id="lives">3</span></div>
<div>‚è± <span id="time">30</span></div>
</div>

<canvas id="game" width="400" height="650"></canvas>

<div id="controlBar">
<input type="range" id="slider" min="0" max="360">
</div>

<div class="overlay" id="startScreen">
<h2>Doggyco 3.2</h2>
<input id="playerName" placeholder="Dein Name">
<button onclick="startGame()">Start</button>
</div>

<div class="overlay" id="gameOver" style="display:none;">
<h2>Game Over</h2>
<p id="finalScore"></p>
<button onclick="restart()">Nochmal spielen</button>
</div>

</div>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");
const slider=document.getElementById("slider");

let state="start";
let score,lives,timeLeft,items,dog,spawnTimer;
let audioCtx=new (window.AudioContext||window.webkitAudioContext)();

function init(){
score=0;
lives=3;
timeLeft=30;
items=[];
spawnTimer=0;
dog={x:180,y:520};
}

slider.addEventListener("input",e=>{
dog.x=parseInt(e.target.value);
});

function startGame(){
if(!playerName.value.trim()) return alert("Name eingeben üê∂");
init();
state="play";
document.getElementById("startScreen").style.display="none";
loop();
}

function restart(){
document.getElementById("gameOver").style.display="none";
document.getElementById("startScreen").style.display="flex";
state="start";
}

function spawn(){
if(items.length>=3) return;
let rand=Math.random();
let item={x:Math.random()*360,y:-30,speed:2};
if(rand<0.2){item.type="üëÆ";item.danger=true;item.blink=0;}
else{item.type=["ü¶¥","üç™","üçó"][Math.floor(Math.random()*3)];
item.val=item.type==="ü¶¥"?1:item.type==="üç™"?2:3;}
items.push(item);
}

function loop(){
if(state!=="play")return;

ctx.clearRect(0,0,400,650);
drawBackground();

spawnTimer++;
if(spawnTimer>80){spawn();spawnTimer=0;}

items.forEach((item,i)=>{
item.y+=item.speed;

if(item.danger){
item.blink+=0.1;
ctx.globalAlpha=Math.abs(Math.sin(item.blink));
ctx.fillStyle="red";
}

ctx.font="35px Arial";
ctx.fillText(item.type,item.x,item.y);
ctx.globalAlpha=1;

if(item.y>500 && item.y<550 && item.x>dog.x-20 && item.x<dog.x+40){
if(item.danger){
lives--;
playPostmanSound();
if(lives<=0)return endGame();
}else{
score+=item.val;
playCollectSound();
}
items.splice(i,1);
}
});

ctx.font="40px Arial";
ctx.fillText("üê∂",dog.x,520);

timeLeft-=1/60;
if(timeLeft<=0)return endGame();

updateUI();

requestAnimationFrame(loop);
}

function drawBackground(){
let sky=ctx.createLinearGradient(0,0,0,650);
sky.addColorStop(0,"#87CEEB");
sky.addColorStop(1,"#ffffff");
ctx.fillStyle=sky;
ctx.fillRect(0,0,400,650);

ctx.fillStyle="#6cc24a";
ctx.fillRect(0,580,400,70);

ctx.fillStyle="#444";
ctx.fillRect(0,600,400,50);
}

function updateUI(){
scoreEl.innerText=score;
livesEl.innerText=lives;
timeEl.innerText=Math.ceil(timeLeft);
}

const scoreEl=document.getElementById("score");
const livesEl=document.getElementById("lives");
const timeEl=document.getElementById("time");

/* ===== Improved Soft Sounds ===== */

function playCollectSound(){
let o=audioCtx.createOscillator();
let g=audioCtx.createGain();
g.gain.value=0.03;
o.frequency.value=700;
o.connect(g);g.connect(audioCtx.destination);
o.start();o.stop(audioCtx.currentTime+0.08);
}

function playPostmanSound(){
let o=audioCtx.createOscillator();
let g=audioCtx.createGain();
g.gain.value=0.05;
o.frequency.value=120;
o.type="sawtooth";
o.connect(g);g.connect(audioCtx.destination);
o.start();o.stop(audioCtx.currentTime+0.25);
}

function endGame(){
state="over";
document.getElementById("finalScore").innerText="Score: "+score;
document.getElementById("gameOver").style.display="flex";
}
</script>

</body>
</html>
