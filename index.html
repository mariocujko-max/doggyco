<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Doggyco Ultimate</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;touch-action:none;}
body{
background:radial-gradient(circle at top,#1b2735,#090a0f);
overflow:hidden;
font-family:Arial,sans-serif;
color:white;
}

#wrap{
position:relative;
max-width:480px;
height:100vh;
margin:auto;
overflow:hidden;
}

canvas{
width:100%;
height:100%;
display:block;
}

#ui{
position:absolute;
top:10px;
width:100%;
text-align:center;
z-index:5;
}

#heartDisplay{font-size:28px;}

.stats{
display:flex;
justify-content:space-around;
margin-top:5px;
font-size:16px;
}

#barWrap{
width:80%;
height:8px;
background:#333;
margin:8px auto;
border-radius:10px;
overflow:hidden;
}

#bar{
height:100%;
width:100%;
background:linear-gradient(to right,#00f2fe,#00ff00);
}

.overlay{
position:absolute;
inset:0;
background:rgba(0,0,0,0.85);
display:flex;
flex-direction:column;
justify-content:center;
align-items:center;
z-index:10;
}

button{
padding:12px 30px;
font-size:18px;
background:#00ccff;
border:none;
border-radius:6px;
margin-top:15px;
cursor:pointer;
}

#ranking{
position:absolute;
bottom:10px;
width:100%;
text-align:center;
font-size:14px;
opacity:0.8;
}
</style>
</head>
<body>

<div id="wrap">

<div id="ui">
<div id="heartDisplay">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
<div class="stats">
<div>Score: <span id="score">0</span></div>
<div>Level: <span id="lvl">1</span></div>
</div>
<div id="barWrap"><div id="bar"></div></div>
</div>

<canvas id="game"></canvas>

<div class="overlay" id="startScreen">
<h1>DOGGYCO ULTIMATE</h1>
<button onclick="startGame()">START</button>
</div>

<div class="overlay" id="gameOver" style="display:none;">
<h2>GAME OVER</h2>
<div id="final"></div>
<button onclick="location.reload()">NEUSTART</button>
</div>

<div id="ranking"></div>

</div>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");

let W,H,laneW,lanes=5;
let dogLane=2,dogX=0;
let items=[],spiders=[];
let score=0,level=1,hearts=3,timeLeft=30,combo=0;
let highscore=0,ranking=[];
let active=false,lastTime=0;
let audioCtx=null;

/* Resize */
function resize(){
W=canvas.width=canvas.parentElement.offsetWidth;
H=canvas.height=canvas.parentElement.offsetHeight;
laneW=W/lanes;
dogX=dogLane*laneW+laneW/2;
}
window.addEventListener("resize",resize);
resize();

/* Audio */
function initAudio(){
if(!audioCtx)
audioCtx=new(window.AudioContext||window.webkitAudioContext)();
}
function beep(f){
if(!audioCtx)return;
if(audioCtx.state==="suspended")audioCtx.resume();
let o=audioCtx.createOscillator();
let g=audioCtx.createGain();
o.type="sine";
o.frequency.value=f;
g.gain.value=0.05;
o.connect(g);g.connect(audioCtx.destination);
o.start();
o.stop(audioCtx.currentTime+0.1);
}

/* Start */
function startGame(){
initAudio();
document.getElementById("startScreen").style.display="none";
highscore=localStorage.getItem("doggyHigh")||0;
ranking=JSON.parse(localStorage.getItem("doggyRank"))||[];
active=true;
score=0;level=1;hearts=3;timeLeft=30;combo=0;
items=[];spiders=[];
lastTime=performance.now();
requestAnimationFrame(loop);
}

/* Input */
canvas.onmousemove=e=>{
if(!active)return;
let x=e.clientX-canvas.getBoundingClientRect().left;
dogLane=Math.floor(x/laneW);
};
canvas.ontouchmove=e=>{
e.preventDefault();
let x=e.touches[0].clientX-canvas.getBoundingClientRect().left;
dogLane=Math.floor(x/laneW);
};

/* Loop */
function loop(t){
if(!active)return;
let delta=(t-lastTime)/1000;
lastTime=t;
ctx.clearRect(0,0,W,H);

/* Timer */
timeLeft-=delta;
document.getElementById("bar").style.width=(timeLeft/30)*100+"%";
if(timeLeft<=0){
level++;timeLeft=30;
document.getElementById("lvl").innerText=level;
}

/* Spawn Items */
if(Math.random()<0.03){
let types=["ü¶¥","üçñ","üç™","üëÆ"];
let type=types[Math.floor(Math.random()*types.length)];
items.push({lane:Math.floor(Math.random()*lanes),y:-40,type});
}

/* Spawn Spiders */
if(Math.random()<0.01){
spiders.push({x:Math.random()*W,y:0});
}

/* Draw Items */
for(let i=items.length-1;i>=0;i--){
let it=items[i];
it.y+=200*delta*(1+level*0.2);
let x=it.lane*laneW+laneW/2;
ctx.font="40px Arial";
ctx.textAlign="center";
ctx.fillText(it.type,x,it.y);

if(it.lane===dogLane&&it.y>H-120&&it.y<H-60){
if(it.type==="ü¶¥"){score+=1;beep(400);}
if(it.type==="üçñ"){score+=5;beep(500);}
if(it.type==="üç™"){score+=3;beep(450);}
if(it.type==="üëÆ"){hearts--;combo=0;}
items.splice(i,1);
}
}

/* Spiders */
for(let i=spiders.length-1;i>=0;i--){
let s=spiders[i];
s.y+=150*delta;
ctx.fillText("üï∑Ô∏è",s.x,s.y);
if(Math.abs(s.x-dogX)<30&&s.y>H-140)timeLeft-=1;
if(s.y>H)spiders.splice(i,1);
}

/* Dog */
let target=dogLane*laneW+laneW/2;
dogX+=(target-dogX)*10*delta;
ctx.font="60px Arial";
ctx.fillText("üê∂",dogX,H-70);

/* UI */
document.getElementById("score").innerText=score;
document.getElementById("heartDisplay").innerText="‚ù§Ô∏è".repeat(hearts);

if(score>highscore){
highscore=score;
localStorage.setItem("doggyHigh",highscore);
}

/* Game Over */
if(hearts<=0){
active=false;
ranking.push(score);
ranking.sort((a,b)=>b-a);
ranking=ranking.slice(0,5);
localStorage.setItem("doggyRank",JSON.stringify(ranking));
document.getElementById("gameOver").style.display="flex";
document.getElementById("final").innerHTML=
"Score: "+score+"<br>Highscore: "+highscore;
}

/* Ranking anzeigen */
document.getElementById("ranking").innerHTML=
"Top 5: "+ranking.join(" | ");

requestAnimationFrame(loop);
}
</script>

</body>
</html>

