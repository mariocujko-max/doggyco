<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Doggyco 14.0</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;800&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{
background:linear-gradient(#1b2735,#090a0f);
overflow:hidden;
font-family:'Orbitron',sans-serif;
color:white;
}

#wrap{
position:relative;
max-width:450px;
height:100vh;
margin:auto;
overflow:hidden;
}

canvas{
width:100%;
height:100%;
display:block;
}

#ui{
position:absolute;
top:10px;
left:0;
right:0;
display:flex;
justify-content:space-around;
align-items:center;
font-size:18px;
z-index:10;
}

.big{
font-size:26px;
}

#barWrap{
position:absolute;
top:60px;
left:5%;
width:90%;
height:20px;
background:#222;
border-radius:20px;
overflow:hidden;
box-shadow:0 0 15px #0f0;
}

#bar{
height:100%;
width:100%;
background:linear-gradient(to right,red,yellow,lime);
transition:width 0.2s;
}

.overlay{
position:absolute;
inset:0;
background:rgba(0,0,0,0.85);
display:flex;
justify-content:center;
align-items:center;
flex-direction:column;
z-index:20;
}

button{
padding:15px 30px;
border:none;
border-radius:30px;
background:linear-gradient(45deg,#00ffcc,#00ccff);
font-size:18px;
cursor:pointer;
}
</style>
</head>
<body>

<div id="wrap">
<div id="ui">
<div class="big">‚≠ê <span id="score">0</span></div>
<div class="big" id="hearts">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
<div class="big">LEVEL <span id="lvl">1</span></div>
<div class="big">‚è≥ <span id="timer">30</span></div>
</div>

<div id="barWrap"><div id="bar"></div></div>

<canvas id="game"></canvas>

<div class="overlay" id="startScreen">
<h2>üê∂ DOGGYCO</h2>
<button onclick="startGame()">START</button>
</div>
</div>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");

let W,H,lanes=6,laneW;
let dogLane=3,dogX=0,targetX=0;
let items=[],spiders=[],bubbles=[],clouds=[],birds=[];
let score=0,level=1,hearts=3,timeLeft=30;
let spawnMax=5;
let animationId;
let dragging=false;

/* Resize */
function resize(){
const r=canvas.getBoundingClientRect();
canvas.width=r.width;
canvas.height=r.height;
W=canvas.width;
H=canvas.height;
laneW=W/lanes;
dogX=laneW*dogLane+laneW/2;
}
window.addEventListener("resize",resize);

/* Audio */
const audioCtx=new (window.AudioContext||window.webkitAudioContext)();

function playTone(freq,dur){
let osc=audioCtx.createOscillator();
let gain=audioCtx.createGain();
osc.connect(gain);
gain.connect(audioCtx.destination);
osc.frequency.value=freq;
gain.gain.value=0.1;
osc.start();
osc.stop(audioCtx.currentTime+dur);
}

/* Start */
function startGame(){
resize();
initBackground();
initSpiders();
document.getElementById("startScreen").style.display="none";
loop();
}

/* Background */
function initBackground(){
for(let i=0;i<3;i++)
clouds.push({x:Math.random()*W,y:50+Math.random()*100,s:0.3+Math.random()*0.3});
}

/* Spiders with net */
function initSpiders(){
for(let i=0;i<2;i++){
spiders.push({x:100+Math.random()*200,t:Math.random()*3});
}
}

/* Controls */
canvas.addEventListener("mousedown",()=>dragging=true);
canvas.addEventListener("mouseup",()=>dragging=false);
canvas.addEventListener("mousemove",e=>{
if(dragging){
dogLane=Math.floor(e.offsetX/laneW);
}
});
canvas.addEventListener("touchstart",()=>dragging=true);
canvas.addEventListener("touchend",()=>dragging=false);
canvas.addEventListener("touchmove",e=>{
let rect=canvas.getBoundingClientRect();
let x=e.touches[0].clientX-rect.left;
dogLane=Math.floor(x/laneW);
});

/* Spawn */
function spawn(){
if(items.length>=spawnMax)return;
let lane=Math.floor(Math.random()*lanes);
if(items.some(it=>it.lane===lane && it.y<120))return;
let r=Math.random();
let it={lane:lane,y:-40};
if(r<0.15){it.type="üëÆ";it.bad=true;}
else if(r<0.4){it.type="üçó";it.val=3;}
else if(r<0.7){it.type="üç™";it.val=2;}
else{it.type="ü¶¥";it.val=1;}
items.push(it);
}

/* Loop */
function loop(){
animationId=requestAnimationFrame(loop);
ctx.clearRect(0,0,W,H);

/* Sky */
let grad=ctx.createLinearGradient(0,0,0,H);
grad.addColorStop(0,"#6ec6ff");
grad.addColorStop(1,"#e3f2fd");
ctx.fillStyle=grad;
ctx.fillRect(0,0,W,H);

/* Clouds */
clouds.forEach(c=>{
c.x+=c.s;
if(c.x>W+100)c.x=-100;
ctx.fillStyle="white";
ctx.beginPath();
ctx.arc(c.x,c.y,30,0,Math.PI*2);
ctx.arc(c.x+30,c.y+10,25,0,Math.PI*2);
ctx.fill();
});

/* Road */
ctx.fillStyle="#444";
ctx.fillRect(0,H-120,W,120);
ctx.fillStyle="#fff";
ctx.fillRect(W/2-5,H-120,10,120);

/* Timer */
timeLeft-=1/60;
if(timeLeft<=0){
level++;
timeLeft=30;
}
document.getElementById("timer").innerText=Math.ceil(timeLeft);
document.getElementById("bar").style.width=(timeLeft/30*100)+"%";

/* Spawn chance */
if(Math.random()<0.02+level*0.005)spawn();

/* Items */
items.forEach((it,i)=>{
it.y+=2+level*0.5;
let x=it.lane*laneW+laneW/2;
ctx.font="36px Arial";
ctx.fillText(it.type,x-18,it.y);

if(it.y>H-130 && it.lane===dogLane){
if(it.bad){
hearts--;
playTone(200,0.3);
bubbles.push({x:x,y:it.y,text:"-‚ù§Ô∏è",life:60});
}else{
let pts=it.val*level;
score+=pts;
playTone(600,0.1);
bubbles.push({x:x,y:it.y,text:"+"+it.type,life:60});
}
items.splice(i,1);
}
});

/* Spiders with net */
spiders.forEach(s=>{
s.t+=0.02;
let sy=(Math.sin(s.t)+1)/2*(H-200);
ctx.strokeStyle="#aaa";
ctx.beginPath();
ctx.moveTo(s.x,0);
ctx.lineTo(s.x,sy);
ctx.stroke();
ctx.fillText("üï∑Ô∏è",s.x-10,sy);

if(Math.abs(s.x-dogX)<40 && Math.abs(sy-(H-120))<40){
timeLeft-=6;
bubbles.push({x:s.x,y:sy,text:"-20%",life:60});
}
});

/* Dog smooth */
targetX=dogLane*laneW+laneW/2;
dogX+=(targetX-dogX)*0.15;
ctx.font="60px Arial";
ctx.fillText("üê∂",dogX-30,H-120);

/* Bubbles */
bubbles.forEach((b,i)=>{
b.y-=1;
b.life--;
ctx.fillStyle="white";
ctx.fillText(b.text,b.x-15,b.y);
if(b.life<=0)bubbles.splice(i,1);
});

/* UI */
document.getElementById("score").innerText=score;
document.getElementById("hearts").innerText="‚ù§Ô∏è".repeat(hearts);
document.getElementById("lvl").innerText=level;

if(hearts<=0){
cancelAnimationFrame(animationId);
alert("Game Over");
location.reload();
}
}
</script>
</body>
</html>
